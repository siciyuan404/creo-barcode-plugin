# Creo 条形码插件测试步骤

## 测试环境
- **Creo 版本**: 8.0.9.0
- **插件版本**: 2.0 (优化版)
- **DLL 位置**: `build_dll/bin/Release/creo_barcode.dll`

## 测试步骤

### 1. 加载插件
```
1. 启动 Creo Parametric
2. 在命令行输入：dll_load C:\path\to\creo_barcode.dll
3. 确认插件加载成功（无错误信息）
```

### 2. 基本功能测试

#### 测试 A：单个条形码生成
```
1. 在 Creo 中打开任意零件（.prt 文件）
2. 创建或打开对应的工程图（.drw 文件）
3. 在菜单中找到条形码相关命令
4. 点击 "Generate Barcode"
5. 观察是否弹出对话框显示图片路径
6. 检查临时目录是否生成了 BMP 文件
```

**预期结果**：
- ✅ 不应该崩溃
- ✅ 弹出对话框显示成功信息和文件路径
- ✅ 临时目录生成 `barcode_<零件名>.bmp` 文件

#### 测试 B：设置功能
```
1. 点击 "Settings" 按钮
2. 尝试修改条形码尺寸
3. 确认设置保存
```

**预期结果**：
- ✅ 设置对话框正常显示
- ✅ 可以修改参数
- ✅ 新设置生效

#### 测试 C：批量处理
```
1. 打开包含多个零件的装配体工程图
2. 点击 "Batch Process"
3. 确认处理零件数量
4. 检查生成的多个条形码文件
```

**预期结果**：
- ✅ 正确识别工程图中的零件
- ✅ 为每个零件生成对应的条形码文件

### 3. 图片质量验证

#### 检查生成的 BMP 文件：
```
1. 打开临时目录中的 barcode_*.bmp 文件
2. 检查图片质量：
   - 条形码是否清晰
   - 黑白对比是否明显
   - 尺寸是否符合设置
3. 使用条形码扫描器或手机 APP 测试扫描
```

**预期结果**：
- ✅ 图片清晰，无模糊
- ✅ 条形码可以正常扫描
- ✅ 扫描结果为零件名称

### 4. 手动插入图片测试

#### 在 Creo 中插入生成的条形码：
```
1. 在工程图中，点击 Insert > Object > Bitmap Image
2. 浏览到插件生成的 BMP 文件
3. 在工程图上点击放置位置
4. 调整图片大小（如需要）
```

**预期结果**：
- ✅ 图片成功插入到工程图
- ✅ 图片显示清晰
- ✅ 可以调整位置和大小

### 5. 错误处理测试

#### 测试异常情况：
```
1. 在没有打开模型时点击 "Generate Barcode"
2. 在没有打开工程图时测试批量处理
3. 使用非常长的零件名称
4. 设置极端的尺寸参数
```

**预期结果**：
- ✅ 显示适当的错误信息
- ✅ 不应该崩溃
- ✅ 能够优雅地处理错误

## 常见问题排查

### 问题 1：插件加载失败
**可能原因**：
- DLL 路径不正确
- 缺少依赖库
- Creo 版本不兼容

**排查步骤**：
1. 检查 DLL 文件是否存在
2. 确认 Creo Toolkit 路径正确
3. 查看 Creo 命令行的错误信息

### 问题 2：点击按钮无响应
**可能原因**：
- 插件命令未正确注册
- 权限问题

**排查步骤**：
1. 重新加载插件
2. 检查 Creo 消息窗口
3. 确认当前用户有写入临时目录的权限

### 问题 3：生成的图片无法扫描
**可能原因**：
- 条形码尺寸过小
- 模块宽度不足
- 数据编码错误

**排查步骤**：
1. 增加条形码尺寸（宽度 > 300，高度 > 80）
2. 检查零件名称是否包含特殊字符
3. 使用在线条形码验证工具检查

### 问题 4：临时文件找不到
**可能原因**：
- 临时目录权限问题
- 磁盘空间不足

**排查步骤**：
1. 检查 %TEMP% 目录权限
2. 确认磁盘空间充足
3. 手动指定输出目录（如果支持）

## 性能测试

### 单个条形码生成时间
- **目标**: < 1 秒
- **测试方法**: 计时从点击按钮到文件生成完成

### 批量处理性能
- **目标**: 每个条形码 < 0.5 秒
- **测试方法**: 处理 10 个零件的总时间

### 内存使用
- **目标**: 无内存泄漏
- **测试方法**: 连续生成 100 个条形码，监控内存使用

## 测试报告模板

```
测试日期：____
测试人员：____
Creo 版本：____
插件版本：____

基本功能测试：
□ 插件加载成功
□ 单个条形码生成正常
□ 设置功能正常
□ 批量处理正常

图片质量测试：
□ 图片清晰度良好
□ 条形码可扫描
□ 尺寸符合设置

错误处理测试：
□ 错误信息显示正确
□ 无崩溃现象
□ 异常情况处理得当

性能测试：
□ 生成速度满足要求
□ 无内存泄漏
□ 批量处理效率良好

总体评价：
□ 通过  □ 部分通过  □ 未通过

问题记录：
1. ________________
2. ________________
3. ________________

建议改进：
1. ________________
2. ________________
3. ________________
```

## 下一步计划

根据测试结果：

### 如果测试通过
- 准备发布版本
- 编写用户手册
- 制作演示视频

### 如果发现问题
- 记录具体错误信息
- 分析崩溃原因
- 制定修复计划

### 优化方向
- 提高生成速度
- 改善用户体验
- 增加更多条形码类型支持

---

**测试版本**: 2.0  
**文档更新**: 2025-12-22